<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0/EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="nemo.mapper.ItemMapper">
   
   <!--상품 main 조회 -->
   <select id="selectItemList" parameterType="String" resultType="nemo.dto.ItemDto">
      select item_num, item_maincategory, item_subcategory,item_name,item_price,item_deposit
           ,item_date,item_readcount,item_detail 
           ,item_writer, item_weather, item_image,item_imagepath, item_topsize, item_bottomsize,
           item_etcsize,item_rentalstart,item_rentalend,files
        from item
       where item_maincategory = #{itemMaincategory}
       order by item_num desc;
    </select>
    
    <!--상품 sub 조회 -->
   <select id="selectItemsubList" parameterType="String" resultType="nemo.dto.ItemDto">
      select item_num, item_maincategory, item_subcategory,item_name,item_price,item_deposit
           ,item_date,item_readcount,item_detail 
           ,item_writer, item_weather, item_image,item_imagepath, item_topsize, item_bottomsize,
           item_etcsize,item_rentalstart,item_rentalend,files
        from item
       where item_subcategory = #{itemSubcategory}
       order by item_num desc;
    </select> 
    
    <!--내상품조회 -->
   <select id="myItemList" parameterType="String" resultType="nemo.dto.ItemDto">
      select item_num, item_maincategory, item_subcategory,item_name,item_price,item_deposit
           ,item_date,item_readcount,item_detail 
           ,item_writer, item_weather, item_image,item_imagepath, item_topsize, item_bottomsize,
           item_etcsize,item_rentalstart,item_rentalend,files
        from item
      	where item_writer = #{itemWriter}
       order by item_num desc;
    </select>
    
    <!--상품 조회수 -->
    <update id="updateReadCount" parameterType="int">
		update item set item_readcount = item_readcount + 1  where item_num =#{itemNum}
	</update>

   <!-- 상품등록 -->
   <insert id="insertItem" parameterType="nemo.dto.ItemDto">
      insert into item (item_maincategory, item_subcategory, item_name,item_price,item_deposit,
                    item_date,item_readcount,item_detail ,item_writer,item_weather,item_image,item_imagepath,
                    item_topsize,item_bottomsize,item_etcsize,item_rentalstart,item_rentalend,files) 
      values ( #{itemMaincategory}, #{itemSubcategory},#{itemName},#{itemPrice},#{itemDeposit},now(),
            #{itemReadcount},#{itemDetail},#{itemWriter},#{itemWeather},"1","1",
            #{itemTopsize},#{itemBottomsize},#{itemEtcsize},#{itemRentalstart},#{itemRentalend},#{files})
   </insert>
   
   
   <!--상품리스트 상세-->
   <select id="selectItemDetail" parameterType="int" resultType="nemo.dto.ItemDto">
      select item_num, item_maincategory, item_subcategory,item_name,item_price,item_deposit
           ,item_date,item_readcount,item_detail 
           ,item_writer, item_weather, item_image,item_imagepath, item_topsize, item_bottomsize,
           item_etcsize,item_rentalstart,item_rentalend,files
        from item
      where item_num =#{itemNum}
   </select>
   
   
   <!-- 상품 수정 -->
    <update id="updateItem" parameterType="nemo.dto.ItemDto">
		update item set item_name = #{itemName}, item_weather = #{itemWeather}
		,item_maincategory = #{itemMaincategory}, item_subcategory = #{itemSubcategory}
		,item_price = #{itemPrice}, item_deposit = #{itemDeposit}
		,item_topsize = #{itemTopsize}, item_bottomsize = #{itemBottomsize}, item_etcsize = #{itemEtcsize}
		,item_detail = #{itemDetail}, item_rentalstart = #{itemRentalstart}, item_rentalend = #{itemRentalend}
		,item_date = now()
		  where item_num =#{itemNum}
	</update>
   
   <!-- 상품 삭제 -->
   <delete id="deleteItem" parameterType="int">
      delete from item where item_num = #{itemNum}
   </delete>
   </mapper>
   
   
   