<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0/EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="nemo.mapper.ReviewMapper">

	<!-- 내가 작성한 후기 목록 -->
	<select id="selectMyReviewList" resultType="nemo.dto.ReviewDto">
		SELECT REVIEW_NUM,
		REVIEW_PRODUCTIDX,
		REVIEW_WRITER,
		REVIEW_SATISFACTION, REVIEW_IMAGE,
		REVIEW_CONTENTS, REVIEW_FILES FROM
		review
		WHERE REVIEW_WRITER= #{reviewWriter} ORDER BY REVIEW_NUM DESC;
	</select>
 
	<!-- 내 상품에 대해 상대방이 쓴 후기 목록 -->
	<select id="selectYourReviewList" resultType="nemo.dto.ReviewDto">
		SELECT REVIEW_NUM, REVIEW_IMAGE, REVIEW_ID,
		REVIEW_SATISFACTION, REVIEW_FILES
		FROM REVIEW
		WHERE REVIEW_ID= #{reviewId}
		ORDER BY REVIEW_NUM
		DESC;
	</select>

	<!-- 후기 등록 -->
	<insert id="insertReview" parameterType="nemo.dto.ReviewDto">
		INSERT INTO REVIEW
		(REVIEW_CONTENTS,
		REVIEW_SATISFACTION, REVIEW_WRITER, REVIEW_FILES)
		VALUES (#{reviewContents}, #{reviewSatisfaction},
		#{reviewWriter}, #{reviewFiles});
	</insert>

	<!-- 후기 수정 -->
	<update id="updateReview" parameterType="nemo.dto.ReviewDto">
		UPDATE REVIEW SET
		REVIEW_CONTENTS = #{reviewContents}, REVIEW_SATISFACTION =
		#{reviewSatisfaction},
		REVIEW_IMAGE = #{reviewImage}
		where REVIEW_NUM = #{reviewNum}
	</update>

	<!-- 후기 삭제 -->
	<delete id="deleteReview" parameterType="nemo.dto.ReviewDto">
		DELETE FROM REVIEW
		WHERE
		REVIEW_WRITER=#{reivewWriter} and REVIEW_NUM=#{reviewNum}
	</delete>
	
	<!-- 내 상점 리뷰 중 가장 최근 후기 하나 -->
	<select id="mostRecentReviewOfMyStore" parameterType="nemo.dto.ReviewDto"> 
		SELECT REVIEW_NUM, REVIEW_IMAGE, REVIEW_ID,
		REVIEW_SATISFACTION
		FROM REVIEW
		WHERE REVIEW_ID=#{reviewId}
		ORDER BY REVIEW_NUM
		DESC LIMIT 1;
	</select>
	
	<!-- 내가 쓴 후기 중 가장 최근 후기 둘 -->
	<select id="twoOfMyMostRecentReviews" parameterType="nemo.dto.ReviewDto">
		SELECT REVIEW_NUM,
		REVIEW_WRITER,
		REVIEW_SATISFACTION, REVIEW_IMAGE,
		REVIEW_CONTENTS FROM
		review
		WHERE REVIEW_WRITER=#{reviewWriter} ORDER BY REVIEW_NUM DESC ;
	</select>

</mapper>